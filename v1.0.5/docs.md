<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# client

```go
import "github.com/wisdom-oss/go-healthcheck/client"
```

Package client provides a client which automatically detects the healthcheck server and connects itself to the healthcheck server and triggers the healthcheck and awaits the results.

\#\# Usage

```
import _ "github.com/wisdom-oss/go-healthcheck/client"
```

## Index



# common

```go
import "github.com/wisdom-oss/go-healthcheck/common"
```

Package common provides constants shared between the client and the server to allow central management for these variables.

## Index

- [Constants](<#constants>)


## Constants

<a name="BufferSize"></a>BufferSize dictates the size for the buffers used for reading on the server and client side

```go
const BufferSize = 4096
```

<a name="HealthcheckIPCCommand"></a>HealthcheckIPCCommand contains the message required to trigger a healthcheck on the server

```go
const HealthcheckIPCCommand = "ping"
```

<a name="HealthcheckIPCResponse"></a>HealthcheckIPCResponse is returned if the healthcheck has been successful and the microservice/software product seams to operate as expected

```go
const HealthcheckIPCResponse = "healthy"
```

<a name="HealthcheckSocketNameFile"></a>HealthcheckSocketNameFile contains the name of the file used to store and look up the socket name

```go
const HealthcheckSocketNameFile = ".hc-socket"
```

<a name="SocketPrefix"></a>SocketPrefix contains the prefix required to access the named pipe

```go
const SocketPrefix = `/tmp/`
```

# server

```go
import "github.com/wisdom-oss/go-healthcheck/server"
```

Package server provides a healthcheck server which allows running health checks directly in the main application. It is compatible with Unix\-based operating systems and Windows operating systems

## Index

- [type HealthcheckServer](<#HealthcheckServer>)
  - [func \(s \*HealthcheckServer\) Init\(\)](<#HealthcheckServer.Init>)
  - [func \(s \*HealthcheckServer\) InitFull\(f func\(\) error, ctx context.Context, cancelFunc context.CancelCauseFunc\)](<#HealthcheckServer.InitFull>)
  - [func \(s \*HealthcheckServer\) InitWithCancellableContext\(ctx context.Context, cancelFunc context.CancelCauseFunc\)](<#HealthcheckServer.InitWithCancellableContext>)
  - [func \(s \*HealthcheckServer\) InitWithContext\(ctx context.Context\)](<#HealthcheckServer.InitWithContext>)
  - [func \(s \*HealthcheckServer\) InitWithFunc\(f func\(\) error\)](<#HealthcheckServer.InitWithFunc>)
  - [func \(s \*HealthcheckServer\) Run\(\)](<#HealthcheckServer.Run>)
  - [func \(s \*HealthcheckServer\) Start\(\) \(err error\)](<#HealthcheckServer.Start>)
  - [func \(s \*HealthcheckServer\) Stop\(\)](<#HealthcheckServer.Stop>)


<a name="HealthcheckServer"></a>
## type HealthcheckServer

HealthcheckServer represents a server responsible for handling health checks. Before using it, it needs to be initialized and a healthcheck function needs to be declared and set. Afterward you may start the healthcheck server with the Start function and wait for connections in a goroutine using the Run function

```go
type HealthcheckServer struct {
    // contains filtered or unexported fields
}
```

<a name="HealthcheckServer.Init"></a>
### func \(\*HealthcheckServer\) Init

```go
func (s *HealthcheckServer) Init()
```

Init initializes the healthcheck server with a default context

<a name="HealthcheckServer.InitFull"></a>
### func \(\*HealthcheckServer\) InitFull

```go
func (s *HealthcheckServer) InitFull(f func() error, ctx context.Context, cancelFunc context.CancelCauseFunc)
```

InitFull initializes the healthcheck server with the healthcheck function and cancellable context directly

<a name="HealthcheckServer.InitWithCancellableContext"></a>
### func \(\*HealthcheckServer\) InitWithCancellableContext

```go
func (s *HealthcheckServer) InitWithCancellableContext(ctx context.Context, cancelFunc context.CancelCauseFunc)
```

InitWithCancellableContext initializes the healthcheck server with a custom context and cancel function

<a name="HealthcheckServer.InitWithContext"></a>
### func \(\*HealthcheckServer\) InitWithContext

```go
func (s *HealthcheckServer) InitWithContext(ctx context.Context)
```

InitWithContext initializes the healthcheck server with a custom context

<a name="HealthcheckServer.InitWithFunc"></a>
### func \(\*HealthcheckServer\) InitWithFunc

```go
func (s *HealthcheckServer) InitWithFunc(f func() error)
```

InitWithFunc initializes the healthcheck server with a default context and allows specifying the healthcheck function directly

<a name="HealthcheckServer.Run"></a>
### func \(\*HealthcheckServer\) Run

```go
func (s *HealthcheckServer) Run()
```

Run begins listening for incoming connections on the HealthcheckServer's listener. It continuously accepts connections and launches a goroutine to handle each connection. The goroutine reads the input from the connection and checks if it matches the healthcheck command. If the command is matched, it calls the healthcheck function and writes the healthcheck response to the connection. If any errors occur during the process, the goroutine writes the error message to the connection and closes the connection. The function will exit when the context is canceled, which happens when the Stop method is called on the HealthcheckServer.

\#\# Usage

Since the Run function is blocking it is recommended to run in a goroutine

<a name="HealthcheckServer.Start"></a>
### func \(\*HealthcheckServer\) Start

```go
func (s *HealthcheckServer) Start() (err error)
```

Start starts the healthcheck server by listening on the configured socket. It initializes the \`listener\` field and returns an error if it fails to start the server.

<a name="HealthcheckServer.Stop"></a>
### func \(\*HealthcheckServer\) Stop

```go
func (s *HealthcheckServer) Stop()
```

Stop cancels the context of the healthcheck server which results in the Run function to be stopped and the socket closing automatically

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
